<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="description" content="{% block description %}{% endblock %}" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

        <title>{% block headtitle %}Un-Mute{% endblock %}</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />

        {% block stylesheets %}
            {% stylesheets filter='scssphp, cssrewrite' output="css/layout.min.css"
                "scss/layout.scss"
            %}
                <link rel="stylesheet" href="{{ asset_url }}" />
            {% endstylesheets %}
        {% endblock %}

        <link rel="icon" type="image/png" href="{{ asset('favicon.png') }}" />
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
    </head>
    <body>
        <header>
            {% block header %}
                {% if is_granted('IS_AUTHENTICATED_REMEMBERED') %}
                    <a href="{{ path('fos_user_security_logout') }}">Déconnexion</a>
                    <a href="{{ path('fos_user_profile_edit') }}">Profil</a>
                    <a href="{{ path('user_notifications') }}">Inbox {% set unseen_nb = unseen_notifs_nb() %}{% if unseen_nb > 0 %}({{ unseen_nb }}){% endif %}</a>
                    <a href="{{ path('user_cart') }}">Panier</a>
                    <a href="{{ path('user_my_artists') }}">Mes artistes</a>
                {% else %}
                    <div id="not-auth-perma-links">
                        <a class="btn btn-primary sharp text-uppercase" href="{{ path('fos_user_registration_register') }}">Inscription</a>
                        {% block header_login_link %}<a class="btn btn-primary sharp text-uppercase" data-toggle="modal" data-target="#loginModal" href="{{ path('fos_user_security_login') }}">Connexion</a>{% endblock %}
                    </div>
                {% endif %}
                <div class="jumbotron jumbotron-fluid">
                    <div class="container h-100 justify-content-center align-items-center text-center">
                           <a href="{{ path('homepage') }}"><img id="logo" class="img-fluid" src="{{ asset('images/logo.png') }}" /></a>
                    </div>
                </div>

                <nav id="mainNav" class="navbar navbar-inverse navbar-toggleable-sm">
                    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    {#
                    <a class="navbar-brand mx-auto" href="#">NavBar</a>
                    <div class="navbar-collapse collapse">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('catalog_crowdfundings') }}">Événements</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('catalog_artists') }}">Artistes</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ path('catalog_halls') }}">Salles</a>
                            </li>
                        </ul>
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="#">About</a>
                            </li>
                        </ul>
                    </div>
                    #}
                    <div class="navbar-collapse collapse">
                        <ul class="navbar-nav mx-auto text-center">
                            <li class="nav-item left-nav-item">
                                <a class="nav-link" href="{{ path('about') }}">à propos</a>
                            </li>

                            <li class="nav-item left-nav-item">
                                <a class="nav-link" href="{{ path('catalog_artists') }}">artistes</a>
                            </li>

                            <li id="menuLogo">
                                <img src="{{ asset('images/logo.png') }}" />
                            </li>

                            <li class="nav-item right-nav-item">
                                <a class="nav-link" href="{{ path('catalog_crowdfundings') }}">événements</a>

                            </li>
                            <li class="nav-item right-nav-item">
                                <a class="nav-link" href="{{ path('catalog_halls') }}">salles</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            {% endblock %}
        </header>

        <main>
            {% block modal_login_form %}
                {% if not is_granted('IS_AUTHENTICATED_REMEMBERED') %}
                    {% include '@FOSUser/Security/login_content.html.twig' %}
                {% endif %}
            {% endblock %}

            {% block flashes %}
                {% include ":patterns:notices.html.twig" %}
            {% endblock %}

            {% block errors %}
                {% include ":patterns:errors.html.twig" %}
            {% endblock %}

            {# later
            {% block breadcrumbs %}
                {{ wo_render_breadcrumbs() }}
            {% endblock %}
            #}

            {% block body %}{# Page body comes here #}{% endblock %}
            {% block js_vars %}{% endblock %}
        </main>


        {% block footer %}
            <footer class="footer">
                <div class="footer-links">
                    <ul class="list-inline">
                        <!-- set as many as items as you want -->
                        <li class="list-inline-item"><a href="{{ path('about') }}">à propos</a></li>
                        <li class="list-inline-item"><a href="{{ path('suggestionBox') }}">contact</a></li>
                        <li class="list-inline-item">plan du site</li>
                    </ul>
                </div>
                <div class="copyright">
                    <span class="text-uppercase">© Un-Mute</span>
                </div>
            </footer>
        {% endblock %}

        {% block javascripts %}
            {% include 'patterns/javascripts.html.twig' %}
            {% block jsValidatorInit %}
                {# Client form validation #}
                {{ include('FpJsFormValidatorBundle::javascripts.html.twig') }}

                {{ js_validator_config() }}
                {{ init_js_validation() }}

                <script>
                    $('button[type="submit"]').click(function(event){
                        $(this).closest('form').jsFormValidator('submitForm', event, {
                            showErrors: function(errors, sourceId) {
                                var list = $(this).prev('ul.form-errors');
                                var div;
                                if (!list.length) {
                                    div = $('<div class="invalid-feedback"></div>');
                                    list = $('<ul class="form-errors list-unstyled mb-0"></ul>');
                                    div.append(list);
                                    $(this).before(div);
                                }
                                list.find('.' + sourceId).remove();

                                for (var i in errors) {
                                    var li = $('<li></li>', {
                                        'class': sourceId,
                                        'text': 'custom_'+ errors[i]
                                    });
                                    list.append(li);
                                }
                            }
                        });
                        $(this).closest('form').jsFormValidator('submitForm', event);
                    });
                </script>
            {% endblock %}
            {% block additional_javascripts %}{% endblock %}
        {% endblock %}

    </body>
</html>
